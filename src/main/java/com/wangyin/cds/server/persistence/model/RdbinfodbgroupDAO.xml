<?xml version="1.0" encoding="UTF-8" ?>    
<!DOCTYPE mapper    
PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"    
"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

<mapper namespace="com.wangyin.cds.server.persistence.RdbinfodbgroupDAO">

	<resultMap type="com.wangyin.cds.server.persistence.model.Rdbinfodbgroup" id="RdbinfodbgroupResult">  
		<id column="r_db_info_db_group_id" property="rDbInfoDbGroupId"/>
		<result column="db_group_id" property="dbGroupId"/>
		<result column="db_info_id" property="dbInfoId"/>
		<result column="master_or_slave" property="masterOrSlave"/>
    </resultMap>
	
	<sql id="columnsSql">
		r_db_info_db_group_id,
		db_group_id,
		db_info_id,
		master_or_slave
	</sql>
	
	<sql id="whereSql">
		<where>
			<if test="rdbinfodbgroup !=null">
				<if test="rdbinfodbgroup.dbGroupId!=null">
					and db_group_id = #{rdbinfodbgroup.dbGroupId}
				</if>
				<if test="rdbinfodbgroup.dbInfoId!=null">
					and db_info_id = #{rdbinfodbgroup.dbInfoId}
				</if>
				<if test="rdbinfodbgroup.masterOrSlave!=null">
					and master_or_slave = #{rdbinfodbgroup.masterOrSlave}
				</if>
			</if>
		</where>
	</sql>
	
	<select id="getPageList" resultMap="RdbinfodbgroupResult">
		select * from (select row_.*, rownum rownum_ from (
			select 
			<include refid="columnsSql"/>
			from RDBINFODBGROUP
			<include refid="whereSql"/>
		<![CDATA[
      	)  row_ where rownum <= #{limit} + #{start}) where rownum_ > #{start} 
		]]>
	</select>
	
	<select id="count" resultType="java.lang.Integer">
		select count(*) from RDBINFODBGROUP
		<include refid="whereSql"/>
	</select>
	
	<select id="query" resultMap="RdbinfodbgroupResult">
		select 
		<include refid="columnsSql"/>
		from RDBINFODBGROUP
		<include refid="whereSql"/>
	</select>

	<select id="load" resultMap="RdbinfodbgroupResult">
		select 
		<include refid="columnsSql"/>
		from RDBINFODBGROUP
		where r_db_info_db_group_id=#{rDbInfoDbGroupId}
	</select>

	<update id="update">
		update RDBINFODBGROUP
		<set>
			<if test="rdbinfodbgroup.dbGroupId != null">db_group_id=#{rdbinfodbgroup.dbGroupId},</if>
			<if test="rdbinfodbgroup.dbInfoId != null">db_info_id=#{rdbinfodbgroup.dbInfoId},</if>
			<if test="rdbinfodbgroup.masterOrSlave != null">master_or_slave=#{rdbinfodbgroup.masterOrSlave}</if>
		</set>
		where r_db_info_db_group_id=#{rdbinfodbgroup.rDbInfoDbGroupId}
	</update>

	<insert id="insert" keyProperty="rdbinfodbgroup.rDbInfoDbGroupId">
		insert into RDBINFODBGROUP(
			r_db_info_db_group_id
			<if test="rdbinfodbgroup.dbGroupId!=null">
				,db_group_id
			</if>
			<if test="rdbinfodbgroup.dbInfoId!=null">
				,db_info_id
			</if>
			<if test="rdbinfodbgroup.masterOrSlave!=null">
				,master_or_slave
			</if>
		) values(
			 #{rdbinfodbgroup.rDbInfoDbGroupId}
			<if test="rdbinfodbgroup.dbGroupId!=null">
				 ,#{rdbinfodbgroup.dbGroupId}
			</if>
			<if test="rdbinfodbgroup.dbInfoId!=null">
				 ,#{rdbinfodbgroup.dbInfoId}
			</if>
			<if test="rdbinfodbgroup.masterOrSlave!=null">
				 ,#{rdbinfodbgroup.masterOrSlave}
			</if>
		)
	</insert>

	<delete id="delete">
		delete from RDBINFODBGROUP
		where r_db_info_db_group_id=#{rDbInfoDbGroupId}
	</delete>

</mapper> 